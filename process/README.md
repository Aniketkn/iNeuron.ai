# Global liveability indicators project #
## Process folder ##

Scripts in this process folder have been updated and brought in from a separate Australia based national project and the Bangkok branch global indicator project. These scrtipts are in the process of being re-factored for a more stream-lined and generalised.    

Open Street map data is being used as a major source of street network database, with the idea that once the scripts are developed, they can be upscaled to other cities. However, modifications will be required to be made to each study region implementation to work in a global context.  

This Phoenix branch is a proposed location for updates for the broader global indicators project. Scripts in each notebook are created to prepare data and index necessary for indicator calculation in a global context. In this branch, we used data from the greater phoenix area (one of the study region in the project) in the U.S.A to test the workability of the scripts. Ultimately, the goal is for the scripts to work for all study regions of our interest for a broader context. 



### Overview ### 
In this process folder, each notebook is developed in a sequential order to create the project database and index. In general, scripts in each notebook describe the processes to produce data, variables, and proposed indicators. This is an initial step for method development and would be an an ongoing effort for global indicator project. Functions developed/imported in each notebook are stored in ```.py``` files (e.g. ```setup_OSMnetwork.py; setup_local_analysis.py; setup_GHSpop_urban.py```), and study region parameters are stored in ```config.py```. These functions and parameters are imported in notebooks to produce network database and project indicators. Each notebook also contains method and process description to produce the output. Therefore, future investigators could apply the same logic and customize study region parameters accordingly to generate study region database and index.    


### Method (In progress) ###
Two major components in this project are local spatial distribution of indicators and overall city-level indicators. Methods are described by notebook basis. In summary, study region boundary is set up and defined based on provided administrative data (```01_create_studyregion```). Then, we use this supplied boundary to retrieve street network data from open street map (OSM) (```02_create_osm_resources```). Study region files are projected to lat-lng for consistency, and to the local UTM projection (using osmnx) when needed for meter-based calculations.    


For local neighborhood indicators, We limit the calculation within designated "urban areas" of the study region to justify OSM usage. Global Human Settlement (GHS) is used as a source to define study region built-up/urban area (```03_create_builtup_urban_GHSL```). We then create sample points with 30m intervals along the walkable street network as the original points for OD analysis or other location-based indicators calculation. Sample points are restricted within the defined built-up/urban areas.  (```04_create_sample_points```). 

Next, 'sausage buffer' approach is used to define local walkable neighborhood. It is a street network buffer created by sample point basis. For each sample point, 50m buffers are created along the street network for 1600m walking distance of the sample point (correspond with 20min walk). 'Sausage buffer' is created for each sample point and each is regarded as a local walkable neighborhood. This approach is useful to calculate location based indicators. Basic statistics are generated for each local walkable neighborhood using osmnx package including area in km, clean intersection count, clean intersection density, distance from sample point to the nearest node. (```04a_create_sausage_buffer```). 

Next, we use Global Human Settlement (GHS) as a source for study region population. Population density is created for each study region by 250m grid (```05_create_population_GHSL```). Census population data supplied by the city administration would be used to verify this population source (```05a_setup_admin_level_population```).      

The above processes are the basic methodology to set up project street network database and local indicator index.   

```06_create_som_pois; 07_create_frequent_public_transport``` describe the process to retiain daily living point of interest data (supermarket, convenience store) from OSM and public transport data from GTFS source within the buffered study region boundary (consider the edge effect). Accessibility scores are generated by counting whether daily desitination points are located within 400m/800m/1600m (5min/10min/20min) walk of each local walkable neighborhood (within sample point 'sausage buffer'). Two approaches could be used to produce daily living accessibility scores: pandana accessibility and sausagebuffer accessibility. Please see specific notebooks for detailed steps.     

Once local indicators (street connectivity, daily living accessibility score) are calculated per sample point basis, these local indicators would be aggregated up to 250m populatin grid cell. Then we have population density, street connectivity, and daily living access at 250m grid cell level. Then, we can calculate respective z-scores of population (or dwelling) density, street connectivity and daily living scores. Walkability index is calculated by summing z-scores of respective variables for 250m grid cells.(```08_aggregate_samplepoint_to_grid```)    
   
Spatial distribution of walkability index by grid cell would be presented through webmap within each study region. (**next step**)   

Regarding the overall indicator relative to the study region, we can aggregate grid-level indicators up to the city level. (**next step**) 


### Expected indicators ### 
Walkability index: street connectivity; population density; daily living scores  

#### Variables:  ####
1. **Walkable street connectivity**: walkable street network are derived from OSM using osmnx. We use osmnx to retrive clean intersection density as a proxy for street connectivity. Then, we aggregate local street connectivity to 250m grid level. Next, we standardize the values of intersection density measured with z-scores values and normalize them on the scale from 0 to 1 in order for the results to be comparable with the other variables of the index.  

2. **Population density**: population data is obtained from Global Human Settlement (GHS) for the study region. We download population raster by 250m grid for each study region. The values of population density are shown by 250m grid, and are standardized with the z-scores.  

3. **Access to supermarket and convenience store (400m/800m/1600m buffer zones)**: point data for supermarket and convenience stores are obtained from OSM database. 1600m buffer zones are created for local neighborhood correspond to 20 minute walking distance. Score is calculated with 1=at least one point located within walkable neighborhood, 0=no point of interest within the walking distance. Scores are aggregated up to 250m grid and standardized with the z-scores.  

4. **Access to frequent transport stops (400m/800m/1600m buffer zones)**: public transport data are derived from GTFS data for each study region. We only considere frequent tranport stops that are operated on a daily basis with less than 30 min interval wait time (see specific notebook for more detailed frequency criteria). Once frequent transport stop points are determined, then, accessibility scores are calculated in the same manner as the supermarket-stores accessibility.   

